{"title":"Flutter的Windows套件 - webview_windows (1)","uid":"0cfcd5c1d8f2bc76951fe50e2b682f11","slug":"flutter-webview-windows","date":"2021-10-07T06:17:28.000Z","updated":"2022-03-08T00:55:26.458Z","comments":true,"path":"api/articles/flutter-webview-windows.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/ZfztlMU.gif","content":"<p>WebView在Flutter的iOS及Android端支援已非常完善，但在Windows及Mac端卻始終沒有支援，在2019年，就有網友在Github提出何時會支援電腦桌面端的WebView套件，但始終沒有消息…</p>\n<p>終於在兩年後，隨著微軟推出了WebView2，終於也有大神在Flutter為Windows開發了<a href=\"https://pub.dev/packages/webview_windows\">Webview</a>套件！！！</p>\n<p>今天就來好好了解該怎麼使用這個套件吧～</p>\n<h3 id=\"配置需求\"><a href=\"#配置需求\" class=\"headerlink\" title=\"配置需求\"></a>配置需求</h3><ul>\n<li><p>用戶端的電腦</p>\n<ul>\n<li><a href=\"https://developer.microsoft.com/zh-tw/microsoft-edge/webview2/\">WebView2 執行階段</a><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>當然要debug的話也是要安裝</p></blockquote>\n</li>\n<li>Windows 10 1809+</li>\n</ul>\n</li>\n<li><p>開發端的電腦</p>\n<ul>\n<li><a href=\"https://visualstudio.microsoft.com/zh-hant/downloads/\">Visual Studio 2019</a></li>\n<li>Windows 10 SDK 2004+ (10.0.19041.0)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Tips\"><a href=\"#Tips\" class=\"headerlink\" title=\"Tips\"></a>Tips</h4><p>查看看Windows的版本：<strong>開始</strong> &gt; <strong>設定</strong> &gt; <strong>系統</strong> &gt; <strong>關於</strong><br><img src=\"https://i.imgur.com/yZKv4QW.png\" alt=\"windows_ver\"></p>\n<h3 id=\"安裝\"><a href=\"#安裝\" class=\"headerlink\" title=\"安裝\"></a>安裝</h3><p>首先，當然就是將套件放進<code>pubspec.yaml</code>中</p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\">dev_dependencies:\n  webview_windows: ^0.0.8</code></pre>\n\n<p>然後安裝套件</p>\n<pre class=\"line-numbers language-console\" data-language=\"console\"><code class=\"language-console\">$ flutter pub get</code></pre>\n<p>再將它匯入專案中</p>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">import &#39;package:webview_windows&#x2F;webview_windows.dart&#39; as wweb;</code></pre>\n\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><p>首先，我們先宣告一個Controller來控制WebView</p>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">final _winController &#x3D; wweb.WebviewController();</code></pre>\n<p>並寫一個初始WebView的function</p>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">Future&lt;void&gt; initWindowsWebView() async &#123;\n  if (!Platform.isWindows) return;\n  await _winController.initialize();  &#x2F;&#x2F; 初始WebView\n  await _winController.loadUrl(\n      &quot;https:&#x2F;&#x2F;developer.microsoft.com&#x2F;en-us&#x2F;microsoft-edge&#x2F;webview2&#x2F;&quot;); &#x2F;&#x2F; 載入頁面\n  while (!_winController.value.isInitialized) &#123; &#x2F;&#x2F; 等待初始完成\n    sleep(Duration(milliseconds: 200));\n  &#125;\n  setState(() &#123;&#125;); &#x2F;&#x2F; 重整頁面UI\n&#125;</code></pre>\n\n<p>再將<code>initWindowsWebView()</code>放至<code>initState()</code>中</p>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">@override\nvoid initState() &#123;\n  super.initState();\n  initWindowsWebView();\n&#125;</code></pre>\n\n<p>然後切記!要在離開頁面時關閉WebviewController</p>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">@override\nvoid dispose() &#123;\n  super.dispose();\n  _winController.dispose();\n&#125;</code></pre>\n\n<p>寫完動作後，我們再來寫一個Widget來顯示WebView</p>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">Widget webView() &#123;\n  if (!Platform.isWindows)\n    return Center(\n      child: Text(&quot;not Support&quot;),\n    );\n  if (!_winController.value.isInitialized)\n    return Center(\n      child: CircularProgressIndicator(), &#x2F;&#x2F; 未初始完成顯示loading圖示\n    );\n  return Container(\n    child: wweb.Webview(_winController),\n  );\n&#125;</code></pre>\n\n<p>最後，再將Wiget放進頁面就完成了~</p>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">@override\nWidget build(BuildContext context) &#123;\n  return Scaffold(\n    appBar: AppBar(\n      title: Text(&quot;WebView&quot;),\n    ),\n    body: webView(),\n  );\n&#125;</code></pre>\n\n<h3 id=\"另人激動的成果時間\"><a href=\"#另人激動的成果時間\" class=\"headerlink\" title=\"另人激動的成果時間\"></a>另人激動的成果時間</h3><p><img src=\"https://i.imgur.com/ZfztlMU.gif\" alt=\"webview preview\"></p>\n<h3 id=\"Full-Code\"><a href=\"#Full-Code\" class=\"headerlink\" title=\"Full Code\"></a>Full Code</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>完整程式碼請至<a href=\"https://github.com/cailirl980519/sample_windows_webview\">sample_windows_webview</a></p></blockquote>\n<pre class=\"line-numbers language-dart\" data-language=\"dart\"><code class=\"language-dart\">import &#39;dart:io&#39;;\n\nimport &#39;package:flutter&#x2F;material.dart&#39;;\nimport &#39;package:lottie&#x2F;lottie.dart&#39;;\nimport &#39;package:webview_windows&#x2F;webview_windows.dart&#39; as wweb;\n\nclass WebViewPage extends StatefulWidget &#123;\n  const WebViewPage(&#123;Key? key&#125;) : super(key: key);\n\n  @override\n  _WebViewPageState createState() &#x3D;&gt; _WebViewPageState();\n&#125;\n\nclass _WebViewPageState extends State&lt;WebViewPage&gt; &#123;\n  final _winController &#x3D; wweb.WebviewController();\n\n  Future&lt;void&gt; initWindowsWebView() async &#123;\n    if (!Platform.isWindows) return;\n    await _winController.initialize();  &#x2F;&#x2F; 初始WebView\n    await _winController.loadUrl(\n        &quot;https:&#x2F;&#x2F;developer.microsoft.com&#x2F;en-us&#x2F;microsoft-edge&#x2F;webview2&#x2F;&quot;); &#x2F;&#x2F; 載入頁面\n    while (!_winController.value.isInitialized) &#123; &#x2F;&#x2F; 等待初始完成\n      sleep(Duration(milliseconds: 200));\n    &#125;\n    setState(() &#123;&#125;); &#x2F;&#x2F; 重整頁面UI\n  &#125;\n\n  Widget webView() &#123;\n    if (!Platform.isWindows)\n      return Center(\n        child: Text(&quot;not Support&quot;),\n      );\n    if (!_winController.value.isInitialized)\n      return Center(\n        child: CircularProgressIndicator(), &#x2F;&#x2F; 未初始完成顯示loading圖示\n      );\n    return Container(\n      child: wweb.Webview(_winController),\n    );\n  &#125;\n\n  @override\n  void initState() &#123;\n    super.initState();\n    initWindowsWebView();\n  &#125;\n\n  @override\n  void dispose() &#123;\n    super.dispose();\n    _winController.dispose();\n  &#125;\n\n  @override\n  Widget build(BuildContext context) &#123;\n    return Scaffold(\n      appBar: AppBar(\n        title: Text(&quot;Sample1&quot;),\n      ),\n      body: webView(),\n    );\n  &#125;\n&#125;</code></pre>\n","text":"WebView在Flutter的iOS及Android端支援已非常完善，但在Windows及Mac端卻始終沒有支援，在2019年，就有網友在Github提出何時會支援電腦桌面端的WebView套件，但始終沒有消息… 終於在兩年後，隨著微軟推出了WebView2，終於也有大神在Fl...","link":"","photos":[],"count_time":{"symbolsCount":"3.8k","symbolsTime":"3 mins."},"categories":[{"name":"Flutter","slug":"Flutter","count":4,"path":"api/categories/Flutter.json"}],"tags":[{"name":"App","slug":"App","count":5,"path":"api/tags/App.json"},{"name":"Flutter","slug":"Flutter","count":4,"path":"api/tags/Flutter.json"},{"name":"Dart","slug":"Dart","count":4,"path":"api/tags/Dart.json"},{"name":"Windows","slug":"Windows","count":3,"path":"api/tags/Windows.json"},{"name":"Edge Webview2","slug":"Edge-Webview2","count":2,"path":"api/tags/Edge-Webview2.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E9%9C%80%E6%B1%82\"><span class=\"toc-text\">配置需求</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Tips\"><span class=\"toc-text\">Tips</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%9D\"><span class=\"toc-text\">安裝</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">使用</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%A6%E4%BA%BA%E6%BF%80%E5%8B%95%E7%9A%84%E6%88%90%E6%9E%9C%E6%99%82%E9%96%93\"><span class=\"toc-text\">另人激動的成果時間</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Full-Code\"><span class=\"toc-text\">Full Code</span></a></li></ol>","author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}},"mapped":true,"prev_post":{"title":"Flutter的Windows套件 - webview_windows (2)","uid":"84a3161f68ac38ab4f5232fe7866e550","slug":"flutter-webview-windows-2","date":"2021-10-13T06:37:03.000Z","updated":"2022-03-08T00:55:26.458Z","comments":true,"path":"api/articles/flutter-webview-windows-2.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/ZfztlMU.gif","text":"前幾天介紹了webview_windows的基本使用，我們已經學會了如何在Flutter App裡開啟網頁，但通常如果是開啟自己的網頁的話，可能有些Web功能就需要跟Flutter端溝通。今天要來學習如何運用webview_windows來接收網頁的訊息及從Flutter傳訊息至...","link":"","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[{"name":"Flutter","slug":"Flutter","count":4,"path":"api/categories/Flutter.json"}],"tags":[{"name":"App","slug":"App","count":5,"path":"api/tags/App.json"},{"name":"Flutter","slug":"Flutter","count":4,"path":"api/tags/Flutter.json"},{"name":"Dart","slug":"Dart","count":4,"path":"api/tags/Dart.json"},{"name":"Windows","slug":"Windows","count":3,"path":"api/tags/Windows.json"},{"name":"Edge Webview2","slug":"Edge-Webview2","count":2,"path":"api/tags/Edge-Webview2.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}},"next_post":{"title":"那些封裝Flutter for Windows Desktop踩過的坑","uid":"3c82a08cc7dab768d26061638904f16f","slug":"flutter-windows-msix","date":"2021-10-05T09:58:52.000Z","updated":"2022-02-16T01:41:50.248Z","comments":true,"path":"api/articles/flutter-windows-msix.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":[],"text":"當我用Flutter寫完一個App後，想要將這個App封裝成Window的MSIX應用程式，但發現網上Windows Desktop的教學屈指可數，且多數都是英文，於是就產生了想法把它記錄下來，把坑填好，以免以後要用到忘記踩過的坑！ 前置作業 一個欲封裝的Flutter專案 一台...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"Flutter","slug":"Flutter","count":4,"path":"api/categories/Flutter.json"}],"tags":[{"name":"App","slug":"App","count":5,"path":"api/tags/App.json"},{"name":"Flutter","slug":"Flutter","count":4,"path":"api/tags/Flutter.json"},{"name":"Dart","slug":"Dart","count":4,"path":"api/tags/Dart.json"},{"name":"Windows","slug":"Windows","count":3,"path":"api/tags/Windows.json"},{"name":"MSIX","slug":"MSIX","count":1,"path":"api/tags/MSIX.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}}}