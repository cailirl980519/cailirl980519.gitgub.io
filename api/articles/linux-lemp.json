{"title":"Debian安裝LEMP(Linux, Nginx, MariaDB, PHP)","uid":"ed4c3f16919c76b52169c87a48c10328","slug":"linux-lemp","date":"2022-03-04T02:51:55.000Z","updated":"2022-03-08T00:55:26.459Z","comments":true,"path":"api/articles/linux-lemp.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://justher.tw/filesys/image/Justher_images/Ahex-LEMP-1.png","content":"<p>LEMP指的是在L - Linux OS下，安裝E - Nginx(Engine x)、M - MySQL&#x2F;MariaDB、P - PHP，是現在很流行的伺服器組合，是將以往的LAMP中的Apache取代為Nginx，藉此提高伺服器的效能。</p>\n<p>今天就來紀錄一下在Debian10下安裝LEMP的過程～</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>以下指令皆使用root執行</p></blockquote>\n<h2 id=\"前置作業\"><a href=\"#前置作業\" class=\"headerlink\" title=\"前置作業\"></a>前置作業</h2><p>安裝前先更新一下<code>apt-get</code></p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ apt-get update</code></pre>\n\n<h3 id=\"安裝\"><a href=\"#安裝\" class=\"headerlink\" title=\"安裝\"></a>安裝</h3><p>接著快速安裝一下Nginx, MariaDB和PHP</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Debian10 默認 PHP7.3; Debian11 則默認 PHP7.4</p></blockquote>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ apt-get install nginx\n$ apt-get install mariadb-server\n$ apt-get install php php-fpm php-cli php-mysql php-zip php-curl php-xml</code></pre>\n\n<p>安裝完成後，就可以將Nginx及MariaDB啟用了</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ systemctl start nginx\n$ systemctl start mariadb</code></pre>\n\n<p>若要在開機時就啟動Nginx及MariaDB，則輸入以下指令</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ systemctl enable nginx\n$ systemctl enable mariadb</code></pre>\n\n<p>測試Nginx是否啟用</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ systemctl status nginx\n● nginx.service - A high performance web server and a reverse proxy server\n   Loaded: loaded (&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;nginx.service; enabled; vendor preset: enabled)\n   Active: active (running) since Thu 2022-03-03 09:10:15 UTC; 18h ago\n     Docs: man:nginx(8)\n  Process: 457 ExecStartPre&#x3D;&#x2F;usr&#x2F;sbin&#x2F;nginx -t -q -g daemon on; master_process on; (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)\n  Process: 468 ExecStart&#x3D;&#x2F;usr&#x2F;sbin&#x2F;nginx -g daemon on; master_process on; (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)\n Main PID: 483 (nginx)\n    Tasks: 3 (limit: 4651)\n   Memory: 9.6M\n   CGroup: &#x2F;system.slice&#x2F;nginx.service\n           ├─483 nginx: master process &#x2F;usr&#x2F;sbin&#x2F;nginx -g daemon on; master_process on;\n           ├─488 nginx: worker process\n           └─489 nginx: worker process</code></pre>\n\n<p>測試MariaDB是否啟用</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ systemctl status mariadb\n● mariadb.service - MariaDB 10.3.31 database server\n   Loaded: loaded (&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;mariadb.service; enabled; vendor preset: enabled)\n   Active: active (running) since Thu 2022-03-03 09:10:16 UTC; 18h ago\n     Docs: man:mysqld(8)\n           https:&#x2F;&#x2F;mariadb.com&#x2F;kb&#x2F;en&#x2F;library&#x2F;systemd&#x2F;\n  Process: 460 ExecStartPre&#x3D;&#x2F;usr&#x2F;bin&#x2F;install -m 755 -o mysql -g root -d &#x2F;var&#x2F;run&#x2F;mysqld (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)\n  Process: 469 ExecStartPre&#x3D;&#x2F;bin&#x2F;sh -c systemctl unset-environment _WSREP_START_POSITION (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)\n  Process: 479 ExecStartPre&#x3D;&#x2F;bin&#x2F;sh -c [ ! -e &#x2F;usr&#x2F;bin&#x2F;galera_recovery ] &amp;&amp; VAR&#x3D; ||   VAR&#x3D;&#96;cd &#x2F;usr&#x2F;bin&#x2F;..; &#x2F;usr&#x2F;bin&#x2F;galera_rec\n  Process: 701 ExecStartPost&#x3D;&#x2F;bin&#x2F;sh -c systemctl unset-environment _WSREP_START_POSITION (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)\n  Process: 703 ExecStartPost&#x3D;&#x2F;etc&#x2F;mysql&#x2F;debian-start (code&#x3D;exited, status&#x3D;0&#x2F;SUCCESS)\n Main PID: 604 (mysqld)\n   Status: &quot;Taking your SQL requests now...&quot;\n    Tasks: 30 (limit: 4651)\n   Memory: 103.8M\n   CGroup: &#x2F;system.slice&#x2F;mariadb.service\n           └─604 &#x2F;usr&#x2F;sbin&#x2F;mysqld</code></pre>\n\n<p>若皆啟用後，也可以確認一下運行的port，一般情況下Nginx會運行在80 port; MariaDB則會運行在3306 port</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ ss -antpl\nLISTEN    0         128                0.0.0.0:80             0.0.0.0:*        users:((&quot;nginx&quot;,pid&#x3D;489,fd&#x3D;6),(&quot;nginx&quot;,pid&#x3D;488,fd&#x3D;6),(&quot;nginx&quot;,pid&#x3D;483,fd&#x3D;6))   \nLISTEN    0         128                   [::]:80                [::]:*        users:((&quot;nginx&quot;,pid&#x3D;489,fd&#x3D;7),(&quot;nginx&quot;,pid&#x3D;488,fd&#x3D;7),(&quot;nginx&quot;,pid&#x3D;483,fd&#x3D;7))\nLISTEN    0          80            127.0.0.1:3306             0.0.0.0:*        users:((&quot;mariadbd&quot;,pid&#x3D;12181,fd&#x3D;15))</code></pre>\n<p>亦可以使用瀏覽器輸入http:&#x2F;&#x2F;[IP] 檢查Nginx是否安裝成功，若成功則可以看到以下畫面<br><img src=\"https://0xzx.com/wp-content/webp-express/webp-images/doc-root/wp-content/uploads/2021/09/20210917-196.png.webp\"></p>\n<h2 id=\"設置Nginx\"><a href=\"#設置Nginx\" class=\"headerlink\" title=\"設置Nginx\"></a>設置Nginx</h2><p>打開<code>/etc/nginx/sites-available/default</code></p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ vi etc&#x2F;nginx&#x2F;site-available&#x2F;default</code></pre>\n\n<p>新增PHP的配置，並儲存離開</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">server &#123;\n  listen 80 default_server;\n  listen [::]:80 default_server;\n\n  root &#x2F;data; # &lt;&lt;--變更網頁目錄位置\n\n  # Add index.php to the list if you are using PHP\n  index index.html index.htm index.nginx-debian.html index.php; # &lt;&lt;--此處新增index.php\n\n  server_name _;\n\n  location &#x2F; &#123;\n          # First attempt to serve request as file, then\n          # as directory, then fall back to displaying a 404.\n          try_files $uri $uri&#x2F; &#x3D;404;\n  &#125;\n\n  # pass PHP scripts to FastCGI server\n  #\n  location ~ \\.php$ &#123; # &lt;&lt;--此處取消註解\n          include snippets&#x2F;fastcgi-php.conf; # &lt;&lt;--此處取消註解\n  #\n  #       # With php-fpm (or other unix sockets):\n          fastcgi_pass unix:&#x2F;run&#x2F;php&#x2F;php7.3-fpm.sock; # &lt;&lt;--此處取消註解\n  #       # With php-cgi (or other tcp sockets):\n  #       fastcgi_pass 127.0.0.1:9000;\n  &#125; # &lt;&lt;--此處取消註解\n&#125;</code></pre>\n\n<p>接著確認Nginx是否有配置錯誤，若正確則會看到以下訊息</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ nginx -t\nnginx: the configuration file &#x2F;etc&#x2F;nginx&#x2F;nginx.conf syntax is ok\nnginx: configuration file &#x2F;etc&#x2F;nginx&#x2F;nginx.conf test is successful</code></pre>\n\n<p>最後重新啟動Nginx來應用更改的配置</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ systemctl restart nginx</code></pre>\n\n\n<h2 id=\"設置MariaDB\"><a href=\"#設置MariaDB\" class=\"headerlink\" title=\"設置MariaDB\"></a>設置MariaDB</h2><p>運行<code>mysql_secure_installation</code>來初始設置MariaDB</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ mysql_secure_installation\nEnter current password for root (enter for none): \nChange the root password? [Y&#x2F;n] Y\nNew password: \nRe-enter new password: \nRemove anonymous users? [Y&#x2F;n] Y\nDisallow root login remotely? [Y&#x2F;n] Y\nRemove test database and access to it? [Y&#x2F;n] Y\nReload privilege tables now? [Y&#x2F;n] Y</code></pre>\n\n<p>設置完成後即可以登入確認，並檢查MariaDB版本</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ mysql -u root -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 36\nServer version: 10.3.31-MariaDB-0+deb10u1 Debian 10\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement.\n\nMariaDB [(none)]&gt; SELECT VERSION();\n+---------------------------+\n| VERSION()                 |\n+---------------------------+\n| 10.3.31-MariaDB-0+deb10u1 |\n+---------------------------+\n1 row in set (0.000 sec)</code></pre>\n\n<h2 id=\"設置PHP\"><a href=\"#設置PHP\" class=\"headerlink\" title=\"設置PHP\"></a>設置PHP</h2><p>若要變更PHP配置，則要打開<code>/etc/php/7.3/fpm/php.ini</code></p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ vi etc&#x2F;php&#x2F;7.3&#x2F;fpm&#x2F;php.ini</code></pre>\n\n<p>編輯完成後儲存並重啟PHP</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ systemctl restart php7.3-fpm</code></pre>\n\n\n<p>在伺服器根目錄的地方加上<code>index.php</code>並編輯</p>\n<pre class=\"line-numbers language-sh\" data-language=\"sh\"><code class=\"language-sh\">$ vi data&#x2F;info.php</code></pre>\n\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n  echo phpinfo();\n?&gt;</code></pre>\n\n<p>完成後在瀏覽器輸入http:&#x2F;&#x2F;[IP]，若成功則可以看到以下畫面<br><img src=\"https://i.imgur.com/JD4o00c.png\" alt=\"Imgur\"></p>\n","feature":true,"text":"LEMP指的是在L - Linux OS下，安裝E - Nginx(Engine x)、M - MySQL&#x2F;MariaDB、P - PHP，是現在很流行的伺服器組合，是將以往的LAMP中的Apache取代為Nginx，藉此提高伺服器的效能。 今天就來紀錄一下在Debia...","link":"","photos":[],"count_time":{"symbolsCount":"6.1k","symbolsTime":"6 mins."},"categories":[{"name":"Linux","slug":"Linux","count":2,"path":"api/categories/Linux.json"}],"tags":[{"name":"Linux","slug":"Linux","count":2,"path":"api/tags/Linux.json"},{"name":"Debian","slug":"Debian","count":2,"path":"api/tags/Debian.json"},{"name":"GCP","slug":"GCP","count":2,"path":"api/tags/GCP.json"},{"name":"LEMP","slug":"LEMP","count":1,"path":"api/tags/LEMP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%89%8D%E7%BD%AE%E4%BD%9C%E6%A5%AD\"><span class=\"toc-text\">前置作業</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%9D\"><span class=\"toc-text\">安裝</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A8%AD%E7%BD%AENginx\"><span class=\"toc-text\">設置Nginx</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A8%AD%E7%BD%AEMariaDB\"><span class=\"toc-text\">設置MariaDB</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A8%AD%E7%BD%AEPHP\"><span class=\"toc-text\">設置PHP</span></a></li></ol>","author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}},"mapped":true,"prev_post":{},"next_post":{"title":"Linux硬碟的大小事","uid":"07e8e955d7dd4be6cdc3355d39428159","slug":"linux-disk","date":"2022-03-04T01:07:52.000Z","updated":"2022-03-08T00:55:26.458Z","comments":true,"path":"api/articles/linux-disk.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://5.imimg.com/data5/BB/KJ/MY-8593783/laptop-hard-disk-500x500.jpg","text":"今天想要來幫目前已經在運行的GCP VM來掛載一個新的硬碟，使會持續變多的資料不要存在開機碟，而是把他掛載到新的硬碟裡，這樣之後也可以方便地隨著資料增加而擴增。 新增磁碟GCP端首先要從GCP選擇需要增加硬碟的VM，並點擊編輯來新增一個新的硬碟或已存在的硬碟，選擇完後按儲存GCP...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"Linux","slug":"Linux","count":2,"path":"api/categories/Linux.json"}],"tags":[{"name":"Linux","slug":"Linux","count":2,"path":"api/tags/Linux.json"},{"name":"Debian","slug":"Debian","count":2,"path":"api/tags/Debian.json"},{"name":"GCP","slug":"GCP","count":2,"path":"api/tags/GCP.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}},"feature":true}}