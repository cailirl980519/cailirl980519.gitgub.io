{"title":"匯入圖片 Image Picker | Excel VBA","uid":"e080914e4abcb8a7da90117520e38bed","slug":"vba-image-picker","date":"2021-12-20T08:11:11.000Z","updated":"2022-03-08T00:55:26.461Z","comments":true,"path":"api/articles/vba-image-picker.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/uss69V2.png","content":"<h3 id=\"使用VBA開啟匯入圖片對話框\"><a href=\"#使用VBA開啟匯入圖片對話框\" class=\"headerlink\" title=\"使用VBA開啟匯入圖片對話框\"></a>使用VBA開啟匯入圖片對話框</h3><p><video autoplay muted loop src=\"https://imgur.com/HzOPsBL.mp4\" type=\"video/mp4\" style=\"width:100%\"></video></p>\n<h4 id=\"STEP-1-新增模組\"><a href=\"#STEP-1-新增模組\" class=\"headerlink\" title=\"STEP 1 新增模組\"></a>STEP 1 新增模組</h4><p>於VBA Project點擊右鍵插入模組並命名為ImagePicker</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>模組為全域性質，在活頁簿中的所有工作表皆可呼叫</p></blockquote>\n<p><img src=\"https://imgur.com/4v5uq1d.png\" alt=\"vba-image-picker\"></p>\n<h4 id=\"STEP-2-新增function-Show\"><a href=\"#STEP-2-新增function-Show\" class=\"headerlink\" title=\"STEP 2 新增function Show()\"></a>STEP 2 新增function <code>Show()</code></h4><p>新增完成後即可在左側模組的資料夾下看到，點擊兩下即可叫出視窗編輯，接著我們就可以在ImagePicker模組下加入<code>Show()</code>來開啟圖片選擇對話框</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>Windows及Mac的文件選擇需要使用不同方式呼叫</p></blockquote>\n<pre class=\"line-numbers language-vb\" data-language=\"vb\"><code class=\"language-vb\">&#39;開啟圖片選擇對話框\nPublic Function Show() As String &#39;宣告回傳圖片路徑的型態\n    #If Mac Then\n        Show &#x3D; GetFileName_Mac &#39;回傳圖片路徑\n    #Else\n        Show &#x3D; GetFileName_Windows &#39;回傳圖片路徑\n    #End If\nEnd Function\n&#39;Mac選擇照片\nFunction GetFileName_Mac() As String\n    Dim startPath As String\n    Dim script As String\n    Dim result As String\n\n    On Error Resume Next\n    startPath &#x3D; MacScript(&quot;return (path to downloads folder) as String&quot;)\n    script &#x3D; &quot;set applescript&#39;s text item delimiters to &quot;&quot;,&quot;&quot; &quot; &amp; _\n            vbNewLine &amp; _\n            &quot;set theFiles to (choose file of type &quot; &amp; _\n            &quot; &#123;&quot;&quot;png&quot;&quot;,&quot;&quot;jpg&quot;&quot;&#125;&quot; &amp; _\n            &quot;with prompt &quot;&quot;Select an image file&quot;&quot; default location alias &quot;&quot;&quot; &amp; startPath &amp; _\n            &quot;&quot;&quot; multiple selections allowed false) as string&quot; &amp; vbNewLine &amp; _\n            &quot;set applescript&#39;s text item delimiters to &quot;&quot;&quot;&quot; &quot; &amp; vbNewLine &amp; _\n            &quot;return theFiles&quot;\n    result &#x3D; MacScript(script)\n    result &#x3D; Replace$(result, &quot;Macintosh HD&quot;, &quot;&quot;, Count:&#x3D;1)\n    result &#x3D; Replace$(result, &quot;:&quot;, &quot;&#x2F;&quot;)\n    GetFileName_Mac &#x3D; result\nEnd Function\n&#39;Windows選擇照片\nPublic Function GetFileName_Windows() As String\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .AllowMultiSelect &#x3D; False\n        .Title &#x3D; &quot;Select an image file&quot;\n        .Filters.Clear\n        .Filters.Add &quot;All Pictures&quot;, &quot;*.*&quot;\n        .Filters.Add &quot;JPG&quot;, &quot;*.JPG&quot;\n        .Filters.Add &quot;JPEG File Interchange Format&quot;, &quot;*.JPEG&quot;\n        .Filters.Add &quot;Portable Network Graphics&quot;, &quot;*.PNG&quot;\n        If .Show &#x3D; -1 Then\n            GetFileName_Windows &#x3D; .SelectedItems(1)\n        End If\n    End With\nEnd Function</code></pre>\n\n<p><img src=\"https://imgur.com/Q0fDp3a.png\" alt=\"vba-image-picker\"></p>\n<p>完成後便可以按下執行測試，就可以發現已經可以成功叫出選擇選擇圖片的對話框了～可以看到只能選擇我們允許的副檔名</p>\n<p><img src=\"https://imgur.com/uss69V2.png\" alt=\"vba-image-picker\"></p>\n<h4 id=\"STEP-3-關聯至工作表\"><a href=\"#STEP-3-關聯至工作表\" class=\"headerlink\" title=\"STEP 3 關聯至工作表\"></a>STEP 3 關聯至工作表</h4><p>於巨集編輯器左側展開Microsoft Excel物件，打開要關聯的工作表，新增一個Worksheet_BeforeDoubleClick，當點擊兩下儲存格時叫出圖片選擇器</p>\n<p><img src=\"https://imgur.com/5dbpyEt.png\" alt=\"vba-image-picker\"></p>\n<pre class=\"line-numbers language-vb\" data-language=\"vb\"><code class=\"language-vb\">Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim path As String &#39;圖片路徑\n    Dim row As Integer &#39;列數\n    Dim cell As Range\n    &#39;呼叫Module ImagePicker中的Funciton Show\n    path &#x3D; ImagePicker.Show\n    &#39;獲取當前點擊列數\n    row &#x3D; Target.row\n    Set cell &#x3D; Cells(row, 1)\n    If Not path &#x3D; &quot;&quot; Then\n        &#39;將圖片路徑放入儲存格\n        cell.value &#x3D; path\n        &#39;將圖片放進工作表\n        Set img &#x3D; ActiveSheet.Pictures.Insert(path)\n        &#39;設置圖片大小\n        img.Height &#x3D; 50\n        &#39;設置圖片位置（儲存格內置中）\n        img.Left &#x3D; cell.Next.Left + (cell.Width - img.Width) &#x2F; 2\n        img.Top &#x3D; cell.Top + (cell.Height - img.Height) &#x2F; 2\n    End If\nEnd Sub</code></pre>","text":"使用VBA開啟匯入圖片對話框 STEP 1 新增模組於VBA Project點擊右鍵插入模組並命名為ImagePicker 模組為全域性質，在活頁簿中的所有工作表皆可呼叫 STEP 2 新增function Show()新增完成後即可在左側模組的資料夾下看到，點擊兩下即可叫出視窗...","link":"","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[{"name":"Excel VBA","slug":"Excel-VBA","count":3,"path":"api/categories/Excel-VBA.json"}],"tags":[{"name":"Excel","slug":"Excel","count":3,"path":"api/tags/Excel.json"},{"name":"VBA","slug":"VBA","count":3,"path":"api/tags/VBA.json"},{"name":"Image Picker","slug":"Image-Picker","count":1,"path":"api/tags/Image-Picker.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8VBA%E9%96%8B%E5%95%9F%E5%8C%AF%E5%85%A5%E5%9C%96%E7%89%87%E5%B0%8D%E8%A9%B1%E6%A1%86\"><span class=\"toc-text\">使用VBA開啟匯入圖片對話框</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-1-%E6%96%B0%E5%A2%9E%E6%A8%A1%E7%B5%84\"><span class=\"toc-text\">STEP 1 新增模組</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-2-%E6%96%B0%E5%A2%9Efunction-Show\"><span class=\"toc-text\">STEP 2 新增function Show()</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-3-%E9%97%9C%E8%81%AF%E8%87%B3%E5%B7%A5%E4%BD%9C%E8%A1%A8\"><span class=\"toc-text\">STEP 3 關聯至工作表</span></a></li></ol></li></ol>","author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}},"mapped":true,"prev_post":{"title":"擁有強大編輯器的互動動畫 | Rive","uid":"a1ba02270c67cfef276ff1d3adc5f501","slug":"rive-begin","date":"2022-02-14T09:08:53.000Z","updated":"2022-03-08T00:55:26.459Z","comments":true,"path":"api/articles/rive-begin.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://assets.awwwards.com/awards/external/2022/02/620f800b8b5bf159047046.jpg","text":"第一次看到Rive是在Flutter官網的Showcase裡，發現它可以客製化互動動畫，還可以跟著使用者的動作或狀態去改變動畫，也太酷了吧！而且看了Rive的官網簡介發現，他竟然支援超多運行環境(Runtime)的！於是就開始掉入坑內… 支援的Runtime官方 Web Reac...","link":"","photos":[],"count_time":{"symbolsCount":668,"symbolsTime":"1 mins."},"categories":[{"name":"Rive","slug":"Rive","count":1,"path":"api/categories/Rive.json"}],"tags":[{"name":"App","slug":"App","count":5,"path":"api/tags/App.json"},{"name":"Web","slug":"Web","count":3,"path":"api/tags/Web.json"},{"name":"Rive","slug":"Rive","count":1,"path":"api/tags/Rive.json"},{"name":"Interactive Animation","slug":"Interactive-Animation","count":1,"path":"api/tags/Interactive-Animation.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}},"next_post":{"title":"顏色選擇器 Color Dialog | Excel VBA","uid":"3619b270e0e7019ca4cb5d6731aeb2d7","slug":"vba-color-picker","date":"2021-12-17T08:42:46.000Z","updated":"2022-03-08T00:55:26.460Z","comments":true,"path":"api/articles/vba-color-picker.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/C11DgCM.gif","text":"使用VBA開啟顏色選擇器 STEP 1 新增模組於VBA Project點擊右鍵插入模組並命名為ColorDialog 模組為全域性質，在活頁簿中的所有工作表皆可呼叫 STEP 2 新增function Show()新增完成後即可在左側模組的資料夾下看到，點擊兩下即可叫出視窗編輯...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"Excel VBA","slug":"Excel-VBA","count":3,"path":"api/categories/Excel-VBA.json"}],"tags":[{"name":"Excel","slug":"Excel","count":3,"path":"api/tags/Excel.json"},{"name":"VBA","slug":"VBA","count":3,"path":"api/tags/VBA.json"},{"name":"Color Dialog","slug":"Color-Dialog","count":1,"path":"api/tags/Color-Dialog.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}}}