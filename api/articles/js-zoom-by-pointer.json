{"title":"透過Pointer events偵測多點觸控","uid":"13b3e19acd1214ea9632a399d02fbfc3","slug":"js-zoom-by-pointer","date":"2021-10-22T06:17:53.000Z","updated":"2021-12-16T01:39:02.565Z","comments":true,"path":"api/articles/js-zoom-by-pointer.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":null,"content":"<p>在多平台的時代，瀏覽器的輸入事件也越來越多樣化，從早期只有滑鼠可以點擊畫面，到現在有了觸控、觸控筆，於是Pointer events誕生了，它不僅保留了Mouse events的常見屬性，還多了可以追蹤各種類型指針事件的功能，使程式碼可以相容各種不同類型的裝置。</p>\n<p>Pointer events不像Touch events一樣，Pointer events並沒有TouchesList，沒辦法輕易得知目前有幾的觸碰點在畫面上，所以如果要進行縮放這種需要兩隻手指的動作，就需要多寫點程式碼來判斷了，今天就來記錄一下如何用一個事件只能記錄一個觸碰點的Pointer events來偵測多點觸控～</p>\n<h3 id=\"先來個成果時間\"><a href=\"#先來個成果時間\" class=\"headerlink\" title=\"先來個成果時間\"></a>先來個成果時間</h3><p class=\"codepen\" data-height=\"300\" data-default-tab=\"result\" data-slug-hash=\"VwzmQXJ\" data-preview=\"true\" data-editable=\"true\" data-user=\"cailirl980519\" style=\"height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\">\n  <span>See the Pen <a href=\"https://codepen.io/cailirl980519/pen/VwzmQXJ\">\n  pointer-events</a> by cailirl980519 (<a href=\"https://codepen.io/cailirl980519\">@cailirl980519</a>)\n  on <a href=\"https://codepen.io\">CodePen</a>.</span>\n</p>\n<script async src=\"https://cpwebassets.codepen.io/assets/embed/ei.js\"></script>\n\n<h3 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h3><p>一開始，我們先將需要偵測的物件加入事件偵測</p>\n<pre class=\"line-numbers language-js\" data-language=\"js\"><code class=\"language-js\">const t &#x3D; document.getElementById(&quot;target&quot;)\nt.addEventListener(&#39;pointerdown&#39;\t, zoomHandler, false)\nt.addEventListener(&#39;pointermove&#39;\t, zoomHandler, false)\nt.addEventListener(&#39;pointerup&#39;\t\t, zoomHandler, false)\nt.addEventListener(&#39;pointercancel&#39;\t, zoomHandler, false)\nt.addEventListener(&#39;pointerout&#39;\t\t, zoomHandler, false)\nt.addEventListener(&#39;pointerleave&#39;\t, zoomHandler, false)</code></pre>\n\n<p>接下來將每個事件要做的動作加入<code>zoomHandler</code>：</p>\n<ul>\n<li>pointerdown: 將觸碰點加入<code>evCache</code></li>\n<li>pointermove: 找到移動的點並更新至<code>evCache</code></li>\n<li>pointerup, pointercancel, pointerout, pointerleave: 將離開的點從<code>evChache</code>中刪除</li>\n</ul>\n<p>最後判斷畫面上觸碰點的數量，隨著數量的不同，變更目標背景的顏色，用Pointer events偵測多點觸控就這樣完成了～</p>\n<pre class=\"line-numbers language-js\" data-language=\"js\"><code class=\"language-js\">var evCache &#x3D; new Array() &#x2F;&#x2F; 紀錄正觸碰的點\nfunction zoomHandler(e) &#123;\n    e.preventDefault()\n    if (e.type &#x3D;&#x3D; &quot;pointerdown&quot;) &#123; &#x2F;&#x2F; 將觸碰點加入&#96;evCache&#96;\n        evCache.push(e)\n    &#125; else if (e.type &#x3D;&#x3D; &quot;pointermove&quot;) &#123; &#x2F;&#x2F; 找到移動的點並更新至&#96;evCache&#96;\n        for (var i &#x3D; 0; i &lt; evCache.length; i++) &#123;\n            if (e.pointerId &#x3D;&#x3D; evCache[i].pointerId) &#123;\n                evCache[i] &#x3D; e\n                break\n            &#125;\n        &#125;\n    &#125; else &#123;\n        for (var i &#x3D; 0; i &lt; evCache.length; i++) &#123; &#x2F;&#x2F; 將離開的點從&#96;evChache&#96;中刪除\n            if (evCache[i].pointerId &#x3D;&#x3D; e.pointerId) &#123;\n                evCache.splice(i, 1)\n                break\n            &#125;\n        &#125;\n    &#125;\n    switch (evCache.length) &#123;\n        case 0:\n            $(t).css(&quot;background-color&quot;, &quot;transparent&quot;)\n            $(&quot;#text&quot;).html(&quot;Touch Here&quot;)\n            break\n        case 1:\n            $(t).css(&quot;background-color&quot;, &quot;lightgray&quot;)\n            $(&quot;#text&quot;).html(&quot;1 Touches&quot;)\n            break\n        case 2:\n            $(t).css(&quot;background-color&quot;, &quot;lightblue&quot;)\n            $(&quot;#text&quot;).html(&quot;2 Touches&quot;)\n            break\n        case 3:\n            $(t).css(&quot;background-color&quot;, &quot;pink&quot;)\n            $(&quot;#text&quot;).html(&quot;3 Touches&quot;)\n            break\n    &#125;\n&#125;</code></pre>","text":"在多平台的時代，瀏覽器的輸入事件也越來越多樣化，從早期只有滑鼠可以點擊畫面，到現在有了觸控、觸控筆，於是Pointer events誕生了，它不僅保留了Mouse events的常見屬性，還多了可以追蹤各種類型指針事件的功能，使程式碼可以相容各種不同類型的裝置。 Pointer ...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"Javascript","slug":"Javascript","count":2,"path":"api/categories/Javascript.json"}],"tags":[{"name":"Javascript","slug":"Javascript","count":2,"path":"api/tags/Javascript.json"},{"name":"Web","slug":"Web","count":3,"path":"api/tags/Web.json"},{"name":"Pointer events","slug":"Pointer-events","count":1,"path":"api/tags/Pointer-events.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%88%E4%BE%86%E5%80%8B%E6%88%90%E6%9E%9C%E6%99%82%E9%96%93\"><span class=\"toc-text\">先來個成果時間</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%AD%A3%E6%96%87\"><span class=\"toc-text\">正文</span></a></li></ol>","author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}},"mapped":true,"prev_post":{"title":"識別HTML5 Canvas上的圖形（直線、箭號、圓形、矩形...）","uid":"2d4b14f1414f66f6c6120a91d5af0cc2","slug":"js-shape-recognition","date":"2021-10-26T02:52:47.000Z","updated":"2021-12-16T01:39:02.565Z","comments":true,"path":"api/articles/js-shape-recognition.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":null,"text":"在iOS的備忘錄或Samsung Note App裡畫畫都可以將手畫的筆跡轉換成漂亮的圖形，讓我不禁想嘗試HTML5的Canvas是不是也可以做到，今天就來記錄一下如何將HTML5 Canvas上醜醜的圖形變成漂亮的直線、箭號、矩形等等。 開心地展示時間 See the Pen ...","link":"","photos":[],"count_time":{"symbolsCount":"11k","symbolsTime":"10 mins."},"categories":[{"name":"Javascript","slug":"Javascript","count":2,"path":"api/categories/Javascript.json"}],"tags":[{"name":"Javascript","slug":"Javascript","count":2,"path":"api/tags/Javascript.json"},{"name":"Web","slug":"Web","count":3,"path":"api/tags/Web.json"},{"name":"HTML5 Canvas","slug":"HTML5-Canvas","count":1,"path":"api/tags/HTML5-Canvas.json"},{"name":"Shape recognition","slug":"Shape-recognition","count":1,"path":"api/tags/Shape-recognition.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}},"next_post":{"title":"Flutter的Windows套件 - webview_windows (2)","uid":"84a3161f68ac38ab4f5232fe7866e550","slug":"flutter-webview-windows-2","date":"2021-10-13T06:37:03.000Z","updated":"2022-03-08T00:55:26.458Z","comments":true,"path":"api/articles/flutter-webview-windows-2.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/ZfztlMU.gif","text":"前幾天介紹了webview_windows的基本使用，我們已經學會了如何在Flutter App裡開啟網頁，但通常如果是開啟自己的網頁的話，可能有些Web功能就需要跟Flutter端溝通。今天要來學習如何運用webview_windows來接收網頁的訊息及從Flutter傳訊息至...","link":"","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[{"name":"Flutter","slug":"Flutter","count":4,"path":"api/categories/Flutter.json"}],"tags":[{"name":"App","slug":"App","count":5,"path":"api/tags/App.json"},{"name":"Flutter","slug":"Flutter","count":4,"path":"api/tags/Flutter.json"},{"name":"Dart","slug":"Dart","count":4,"path":"api/tags/Dart.json"},{"name":"Windows","slug":"Windows","count":3,"path":"api/tags/Windows.json"},{"name":"Edge Webview2","slug":"Edge-Webview2","count":2,"path":"api/tags/Edge-Webview2.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}}}