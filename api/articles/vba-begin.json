{"title":"新手上路 | Excel VBA","uid":"1dafd30f62e90cb76da6ebadcb8ec7ac","slug":"vba-begin","date":"2021-12-17T02:23:31.000Z","updated":"2022-03-08T00:55:26.460Z","comments":true,"path":"api/articles/vba-begin.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS-00fvxHekpQjhx67FD3YHJe0BU9LM9dRDVxzbD8nxOSJpm-YziSjA0zdQpb3ZI7vfqkk&usqp=CAU","content":"<h3 id=\"開啟VBA\"><a href=\"#開啟VBA\" class=\"headerlink\" title=\"開啟VBA\"></a>開啟VBA</h3><p>點擊工作表右鍵 &gt; 檢視程式碼，即可看到編輯VBA的視窗<br><img src=\"https://imgur.com/1s7J9Ql.png\" alt=\"vba-begin\"><br><img alt=\"vba-begin\" src=\"https://imgur.com/5YSI1h8.png\" style=\"width: 80%;\"></p>\n<h3 id=\"開啟開發人員工作列\"><a href=\"#開啟開發人員工作列\" class=\"headerlink\" title=\"開啟開發人員工作列\"></a>開啟開發人員工作列</h3><ul>\n<li>Windows: 檔案 &gt; 選項 &gt; 自訂功能區 &gt; 勾選開發人員</li>\n<li>Mac: Excel &gt; 喜好設定 &gt; 功能區和工具列 &gt; 勾選開發人員<br><img src=\"https://imgur.com/VTBQgK7.png\" alt=\"vba-begin\"></li>\n</ul>\n<h3 id=\"使用按鈕複製選取儲存格文字\"><a href=\"#使用按鈕複製選取儲存格文字\" class=\"headerlink\" title=\"使用按鈕複製選取儲存格文字\"></a>使用按鈕複製選取儲存格文字</h3><h4 id=\"STEP-1-插入按鈕\"><a href=\"#STEP-1-插入按鈕\" class=\"headerlink\" title=\"STEP 1 插入按鈕\"></a>STEP 1 插入按鈕</h4><ul>\n<li>Windows: 開發人員 &gt; 插入 &gt; 表單控制項中的按鈕</li>\n<li>Mac: 開發人員 &gt; 按鈕<br>接著就在工作表中放置按鈕<br><img src=\"https://imgur.com/Jnyyw9z.png\" alt=\"vba-begin\"><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>若要移動按鈕位置或改變大小，Windows需點擊開發人員中的設計模式; Mac則需右鍵點擊按鈕</p></blockquote>\n</li>\n</ul>\n<h4 id=\"STEP-2-指定巨集\"><a href=\"#STEP-2-指定巨集\" class=\"headerlink\" title=\"STEP 2 指定巨集\"></a>STEP 2 指定巨集</h4><p>新增一個巨集，當按鈕按下後會呼叫<br><img src=\"https://imgur.com/niJHjvK.png\" alt=\"vba-begin\"><br>新增完成即會跳到巨集編輯器<br><img alt=\"vba-begin\" src=\"https://imgur.com/bCf7vGl.png\" style=\"width: 80%;\"></p>\n<h4 id=\"STEP3-編輯巨集功能\"><a href=\"#STEP3-編輯巨集功能\" class=\"headerlink\" title=\"STEP3 編輯巨集功能\"></a>STEP3 編輯巨集功能</h4><p>接著我們就可以開始編寫複製功能</p>\n<ul>\n<li>Selection.Address: 當前選取的儲存格地址</li>\n<li>MsgBox: 提示框<pre class=\"line-numbers language-vb\" data-language=\"vb\"><code class=\"language-vb\">Sub Btn()\n    &#39;選取儲存格的數量\n    If Range(Selection.Address).Count &#x3D; 1 Then\n        &#39;將文字丟進剪貼簿\n        Dim obj As New DataObject\n        obj.SetText Range(Selection.Address).value\n        obj.PutInClipboard\n        MsgBox &quot;已複製：&quot; &amp; obj.GetText\n    Else\n        MsgBox &quot;無法複製多個儲存格&quot;\n    End If\nEnd Sub</code></pre></li>\n</ul>\n<h4 id=\"STEP4-點擊按鈕\"><a href=\"#STEP4-點擊按鈕\" class=\"headerlink\" title=\"STEP4 點擊按鈕\"></a>STEP4 點擊按鈕</h4><p>寫完程式碼後就可以開始測試效果了～<br><img src=\"https://imgur.com/LNDpGpA.gif\" alt=\"vba-begin\"></p>\n<h3 id=\"儲存\"><a href=\"#儲存\" class=\"headerlink\" title=\"儲存\"></a>儲存</h3><p>儲存有巨集的Excel時必須存成<strong>啟用巨集的活頁簿（<code>.*xlsm</code>）</strong>，若存為一般的<code>.*xls</code>是無法啟用巨集的哦～</p>\n","text":"開啟VBA點擊工作表右鍵 &gt; 檢視程式碼，即可看到編輯VBA的視窗 開啟開發人員工作列 Windows: 檔案 &gt; 選項 &gt; 自訂功能區 &gt; 勾選開發人員 Mac: Excel &gt; 喜好設定 &gt; 功能區和工具列 &gt; 勾選開發人員 使用按鈕...","link":"","photos":[],"count_time":{"symbolsCount":813,"symbolsTime":"1 mins."},"categories":[{"name":"Excel VBA","slug":"Excel-VBA","count":3,"path":"api/categories/Excel-VBA.json"}],"tags":[{"name":"Excel","slug":"Excel","count":3,"path":"api/tags/Excel.json"},{"name":"VBA","slug":"VBA","count":3,"path":"api/tags/VBA.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%96%8B%E5%95%9FVBA\"><span class=\"toc-text\">開啟VBA</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%96%8B%E5%95%9F%E9%96%8B%E7%99%BC%E4%BA%BA%E5%93%A1%E5%B7%A5%E4%BD%9C%E5%88%97\"><span class=\"toc-text\">開啟開發人員工作列</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8%E6%8C%89%E9%88%95%E8%A4%87%E8%A3%BD%E9%81%B8%E5%8F%96%E5%84%B2%E5%AD%98%E6%A0%BC%E6%96%87%E5%AD%97\"><span class=\"toc-text\">使用按鈕複製選取儲存格文字</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-1-%E6%8F%92%E5%85%A5%E6%8C%89%E9%88%95\"><span class=\"toc-text\">STEP 1 插入按鈕</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-2-%E6%8C%87%E5%AE%9A%E5%B7%A8%E9%9B%86\"><span class=\"toc-text\">STEP 2 指定巨集</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP3-%E7%B7%A8%E8%BC%AF%E5%B7%A8%E9%9B%86%E5%8A%9F%E8%83%BD\"><span class=\"toc-text\">STEP3 編輯巨集功能</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP4-%E9%BB%9E%E6%93%8A%E6%8C%89%E9%88%95\"><span class=\"toc-text\">STEP4 點擊按鈕</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%84%B2%E5%AD%98\"><span class=\"toc-text\">儲存</span></a></li></ol>","author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}},"mapped":true,"prev_post":{"title":"顏色選擇器 Color Dialog | Excel VBA","uid":"3619b270e0e7019ca4cb5d6731aeb2d7","slug":"vba-color-picker","date":"2021-12-17T08:42:46.000Z","updated":"2022-03-08T00:55:26.460Z","comments":true,"path":"api/articles/vba-color-picker.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/C11DgCM.gif","text":"使用VBA開啟顏色選擇器 STEP 1 新增模組於VBA Project點擊右鍵插入模組並命名為ColorDialog 模組為全域性質，在活頁簿中的所有工作表皆可呼叫 STEP 2 新增function Show()新增完成後即可在左側模組的資料夾下看到，點擊兩下即可叫出視窗編輯...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"Excel VBA","slug":"Excel-VBA","count":3,"path":"api/categories/Excel-VBA.json"}],"tags":[{"name":"Excel","slug":"Excel","count":3,"path":"api/tags/Excel.json"},{"name":"VBA","slug":"VBA","count":3,"path":"api/tags/VBA.json"},{"name":"Color Dialog","slug":"Color-Dialog","count":1,"path":"api/tags/Color-Dialog.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}},"next_post":{"title":"用Isolate實現Loading Widget不卡頓","uid":"2a6644c694560b69458b953b3d0b9644","slug":"flutter-isolate","date":"2021-12-16T07:14:06.000Z","updated":"2022-02-16T01:41:50.247Z","comments":true,"path":"api/articles/flutter-isolate.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":[],"text":" Flutter預設是單執行緒處理，在你還沒發覺UI變得卡頓時，你是不會發現的。 剛開始接觸Flutter時，完全沒有認真研究過他的執行序，認為只要把複雜或需要時間的工作丟進Future, async, await就解決一切了，直到…我發現UI變得超卡的！！於是就誕生了這篇文章…...","link":"","photos":[],"count_time":{"symbolsCount":"3.8k","symbolsTime":"3 mins."},"categories":[{"name":"Flutter","slug":"Flutter","count":4,"path":"api/categories/Flutter.json"}],"tags":[{"name":"App","slug":"App","count":5,"path":"api/tags/App.json"},{"name":"Flutter","slug":"Flutter","count":4,"path":"api/tags/Flutter.json"},{"name":"Dart","slug":"Dart","count":4,"path":"api/tags/Dart.json"},{"name":"Isolate","slug":"Isolate","count":1,"path":"api/tags/Isolate.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}}}