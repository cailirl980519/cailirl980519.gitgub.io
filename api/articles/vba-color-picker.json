{"title":"顏色選擇器 Color Dialog | Excel VBA","uid":"3619b270e0e7019ca4cb5d6731aeb2d7","slug":"vba-color-picker","date":"2021-12-17T08:42:46.000Z","updated":"2022-03-08T00:55:26.460Z","comments":true,"path":"api/articles/vba-color-picker.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/C11DgCM.gif","content":"<h3 id=\"使用VBA開啟顏色選擇器\"><a href=\"#使用VBA開啟顏色選擇器\" class=\"headerlink\" title=\"使用VBA開啟顏色選擇器\"></a>使用VBA開啟顏色選擇器</h3><p><video autoplay muted loop src=\"https://imgur.com/B7Jvktz.mp4\" type=\"video/mp4\" style=\"width:100%\"></video></p>\n<h4 id=\"STEP-1-新增模組\"><a href=\"#STEP-1-新增模組\" class=\"headerlink\" title=\"STEP 1 新增模組\"></a>STEP 1 新增模組</h4><p>於VBA Project點擊右鍵插入模組並命名為ColorDialog</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>模組為全域性質，在活頁簿中的所有工作表皆可呼叫</p></blockquote>\n<p><img src=\"https://imgur.com/4v5uq1d.png\" alt=\"vba-color-dialog\"></p>\n<h4 id=\"STEP-2-新增function-Show\"><a href=\"#STEP-2-新增function-Show\" class=\"headerlink\" title=\"STEP 2 新增function Show()\"></a>STEP 2 新增function <code>Show()</code></h4><p>新增完成後即可在左側模組的資料夾下看到，點擊兩下即可叫出視窗編輯，接著我們就可以在ColorDialog模組下加入<code>Show()</code>來開啟顏色選擇器</p>\n<pre class=\"line-numbers language-vb\" data-language=\"vb\"><code class=\"language-vb\">&#39;開啟顏色選擇對話框\nPublic Function Show() As Long &#39;宣告回傳選中顏色值的型態\n    Dim FullColorCode As Long\n    &#39;如果有選擇並按確認\n    &#39;Application.Dialogs(xlDialogEditColor).Show(Alpha, R, G, B) &lt;-- 初始顏色\n    If Application.Dialogs(xlDialogEditColor).Show(1, 84, 96, 164) &#x3D; True Then\n        FullColorCode &#x3D; ActiveWorkbook.Colors(1)\n    End If\n    Show &#x3D; FullColorCode &#39;回傳選中的顏色\nEnd Function</code></pre>\n<img alt=\"vba-color-dialog\" src=\"https://imgur.com/sSBjKPU.png\" style=\"width: 80%\">\n\n\n<p>完成後便可以按下執行測試，就可以發現已經可以成功叫出選擇顏色的對話框了！<br><img alt=\"vba-color-dialog\" src=\"https://imgur.com/iAaPvSP.png\" style=\"width: 80%\"></p>\n<h4 id=\"STEP-3-關聯至工作表\"><a href=\"#STEP-3-關聯至工作表\" class=\"headerlink\" title=\"STEP 3 關聯至工作表\"></a>STEP 3 關聯至工作表</h4><p>於巨集編輯器左側展開Microsoft Excel物件，打開要關聯的工作表，新增一個<code>Worksheet_BeforeDoubleClick</code>，當點擊兩下儲存格時叫出顏色選擇器</p>\n<pre class=\"line-numbers language-vb\" data-language=\"vb\"><code class=\"language-vb\">Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim color As Long &#39;顏色\n    Dim R, G, B As Integer &#39;RGB值\n    Dim row As Integer &#39;列數\n    Dim cell As Range\n    &#39;呼叫Module ColorDialog中的Funciton Show\n    color &#x3D; ColorDialog.Show\n    &#39;將color轉為RGB\n    R &#x3D; color Mod 256\n    G &#x3D; (color \\ 256) Mod 256\n    B &#x3D; color \\ 65536\n    &#39;獲取點擊列數\n    row &#x3D; Target.row\n    &#39;將儲存格設為點擊列數的B欄\n    Set cell &#x3D; Cells(row, 2)\n    &#39;設置前一個儲存格背景色\n    cell.Previous.Interior.color &#x3D; color\n    &#39;將轉換成HexColor的值放進儲存格\n    cell.value &#x3D; Application.Dec2Hex(R, 2) + Application.Dec2Hex(G, 2) + Application.Dec2Hex(B, 2)\n    &#39;將轉換成RGB的值放進右邊儲存格\n    cell.Next.value &#x3D; R &amp; &quot;, &quot; &amp; G &amp; &quot;, &quot; &amp; B\n    &#39;設置右側儲存格邊框\n    With cell.Next.Borders(xlEdgeRight)\n        .LineStyle &#x3D; xlContinous &#39;邊框樣式\n        .Weight &#x3D; xlThick &#39;邊框粗細\n        .color &#x3D; color &#39;邊框顏色\n    End With\nEnd Sub</code></pre>\n\n<img alt=\"vba-color-dialog\" src=\"https://imgur.com/NKXz86U.png\" style=\"width: 80%\">","text":"使用VBA開啟顏色選擇器 STEP 1 新增模組於VBA Project點擊右鍵插入模組並命名為ColorDialog 模組為全域性質，在活頁簿中的所有工作表皆可呼叫 STEP 2 新增function Show()新增完成後即可在左側模組的資料夾下看到，點擊兩下即可叫出視窗編輯...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"Excel VBA","slug":"Excel-VBA","count":3,"path":"api/categories/Excel-VBA.json"}],"tags":[{"name":"Excel","slug":"Excel","count":3,"path":"api/tags/Excel.json"},{"name":"VBA","slug":"VBA","count":3,"path":"api/tags/VBA.json"},{"name":"Color Dialog","slug":"Color-Dialog","count":1,"path":"api/tags/Color-Dialog.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8VBA%E9%96%8B%E5%95%9F%E9%A1%8F%E8%89%B2%E9%81%B8%E6%93%87%E5%99%A8\"><span class=\"toc-text\">使用VBA開啟顏色選擇器</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-1-%E6%96%B0%E5%A2%9E%E6%A8%A1%E7%B5%84\"><span class=\"toc-text\">STEP 1 新增模組</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-2-%E6%96%B0%E5%A2%9Efunction-Show\"><span class=\"toc-text\">STEP 2 新增function Show()</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#STEP-3-%E9%97%9C%E8%81%AF%E8%87%B3%E5%B7%A5%E4%BD%9C%E8%A1%A8\"><span class=\"toc-text\">STEP 3 關聯至工作表</span></a></li></ol></li></ol>","author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}},"mapped":true,"prev_post":{"title":"匯入圖片 Image Picker | Excel VBA","uid":"e080914e4abcb8a7da90117520e38bed","slug":"vba-image-picker","date":"2021-12-20T08:11:11.000Z","updated":"2022-03-08T00:55:26.461Z","comments":true,"path":"api/articles/vba-image-picker.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://i.imgur.com/uss69V2.png","text":"使用VBA開啟匯入圖片對話框 STEP 1 新增模組於VBA Project點擊右鍵插入模組並命名為ImagePicker 模組為全域性質，在活頁簿中的所有工作表皆可呼叫 STEP 2 新增function Show()新增完成後即可在左側模組的資料夾下看到，點擊兩下即可叫出視窗...","link":"","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[{"name":"Excel VBA","slug":"Excel-VBA","count":3,"path":"api/categories/Excel-VBA.json"}],"tags":[{"name":"Excel","slug":"Excel","count":3,"path":"api/tags/Excel.json"},{"name":"VBA","slug":"VBA","count":3,"path":"api/tags/VBA.json"},{"name":"Image Picker","slug":"Image-Picker","count":1,"path":"api/tags/Image-Picker.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}},"next_post":{"title":"新手上路 | Excel VBA","uid":"1dafd30f62e90cb76da6ebadcb8ec7ac","slug":"vba-begin","date":"2021-12-17T02:23:31.000Z","updated":"2022-03-08T00:55:26.460Z","comments":true,"path":"api/articles/vba-begin.json","keywords":"Flutter, Dart, MSIX, webview_windows, Javascript, Web, VBA, Excel","cover":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS-00fvxHekpQjhx67FD3YHJe0BU9LM9dRDVxzbD8nxOSJpm-YziSjA0zdQpb3ZI7vfqkk&usqp=CAU","text":"開啟VBA點擊工作表右鍵 &gt; 檢視程式碼，即可看到編輯VBA的視窗 開啟開發人員工作列 Windows: 檔案 &gt; 選項 &gt; 自訂功能區 &gt; 勾選開發人員 Mac: Excel &gt; 喜好設定 &gt; 功能區和工具列 &gt; 勾選開發人員 使用按鈕...","link":"","photos":[],"count_time":{"symbolsCount":813,"symbolsTime":"1 mins."},"categories":[{"name":"Excel VBA","slug":"Excel-VBA","count":3,"path":"api/categories/Excel-VBA.json"}],"tags":[{"name":"Excel","slug":"Excel","count":3,"path":"api/tags/Excel.json"},{"name":"VBA","slug":"VBA","count":3,"path":"api/tags/VBA.json"}],"author":{"name":"Shirley","slug":"shirley","avatar":"https://i.imgur.com/lM0jHtF.png","link":"/","description":"記錄雜七雜八的秘密基地","socials":{"github":"https://github.com/cailirl980519","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"book":{"icon":"fa fa-envelope","link":"mailto://cailirl980519@gmail.com"}}}}}}